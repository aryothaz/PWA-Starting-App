{"version":3,"sources":["components/BluetoothInput.js","components/BluetoothConnectButton.js","components/BluetoothConnect.js","components/Bluetooth.js","App.js","index.js"],"names":["BluetoothInput","input","React","createRef","handleSubmit","e","preventDefault","props","onBluetoothInputChange","current","value","emptyInput","target","console","log","onSubmit","this","className","id","type","name","placeholder","ref","onChange","autoComplete","Component","BluetoothConnectButton","onClick","connect","connected","BLEService_UUID","BluetoothConnect","connectToDevice","a","navigator","bluetooth","requestDevice","optionalServices","acceptAllDevices","then","device","onDeviceChange","addEventListener","onDisconnected","gatt","server","onServerChange","getPrimaryService","service","onServiceChange","getCharacteristic","characteristic","onCharacteristicChange","handleNotifications","onConnectedChange","startNotifications","catch","error","disconnect","render","Bluetooth","state","supportsBluetooth","handleDeviceChange","setState","handleServerChange","handleServiceChange","handleCharacteristicChange","handleConnectedChange","handleSupportsBluetoothChange","componentDidMount","event","str","i","byteLength","String","fromCharCode","getUint8","handleBluetoothInputChange","encoder","TextEncoder","array","encode","fin","Int8Array","send","length","set","writeValue","_","App","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.22e2efe1.chunk.js","sourcesContent":["import React from \"react\";\r\n\r\nclass BluetoothInput extends React.Component {\r\n  input = React.createRef();\r\n  handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    this.props.onBluetoothInputChange(this.input.current.value);\r\n  };\r\n  emptyInput = (e) => {\r\n    if (e.target.value === \"\") {\r\n      console.log(this.input.current.value);\r\n      this.props.onBluetoothInputChange(this.input.current.value);\r\n    }\r\n  };\r\n  render() {\r\n    return (\r\n      <form onSubmit={this.handleSubmit} className=\"buscar-form\">\r\n        <input\r\n          id=\"BluetoothInput\"\r\n          type=\"text\"\r\n          className=\"form-control\"\r\n          name=\"BluetoothInput\"\r\n          placeholder=\"Enviar mensaje\"\r\n          ref={this.input}\r\n          onChange={(e) => this.emptyInput(e)}\r\n          autoComplete=\"BluetoothInput\"\r\n        />\r\n        <button type=\"submit\">Enviar</button>\r\n      </form>\r\n    );\r\n  }\r\n}\r\n\r\nexport default BluetoothInput;\r\n","import React from \"react\";\r\n\r\nconst BluetoothConnectButton = (props) => {\r\n  return (\r\n    <div className=\"BluetoothConnect\">\r\n        <button onClick={props.connect}>{props.connected?\"Conectado\":\"Conectar\"}</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BluetoothConnectButton;\r\n\r\n\r\n","import React from \"react\";\r\nimport BluetoothConnectButton from \"./BluetoothConnectButton\";\r\n\r\nconst BLEService_UUID  = 0x1700;\r\nconst BLE_Characteristic_UUID = 0x1A00;\r\n\r\nclass BluetoothConnect extends React.Component {\r\n\r\n    connectToDevice = async () => {\r\n        navigator.bluetooth.requestDevice({\r\n            optionalServices: [BLEService_UUID],\r\n            acceptAllDevices: true\r\n        })\r\n        .then(device => {\r\n            this.props.onDeviceChange(device);\r\n            device.addEventListener('gattserverdisconnected', this.props.onDisconnected);\r\n            return device.gatt.connect();\r\n        })\r\n        .then(server => {\r\n            this.props.onServerChange(server);\r\n            return server.getPrimaryService(BLEService_UUID);\r\n        })\r\n        .then(service => {\r\n            this.props.onServiceChange(service);\r\n            return service.getCharacteristic(BLE_Characteristic_UUID);\r\n        })\r\n        .then(characteristic => {\r\n            this.props.onCharacteristicChange(characteristic);\r\n            characteristic.addEventListener('characteristicvaluechanged',\r\n                                            this.props.handleNotifications);\r\n            this.props.onConnectedChange(true);\r\n            return characteristic.startNotifications();\r\n        })\r\n        .catch(error => {\r\n            if(this.props.device && this.props.device.gatt.connected)\r\n            {\r\n                this.props.device.gatt.disconnect();\r\n            }\r\n            console.log(\"Bluetooth conection: \"+ error);\r\n        });\r\n    };\r\n\r\n    render = () => {\r\n        const {\r\n            connected,\r\n        } = this.props;\r\n        return (\r\n            <BluetoothConnectButton\r\n                connect={this.connectToDevice}\r\n                connected={connected}\r\n            />\r\n        );\r\n    }\r\n}\r\n\r\nexport default BluetoothConnect;","import BluetoothInput from \"./BluetoothInput\";\r\nimport React from \"react\";\r\nimport BluetoothConnect from \"./BluetoothConnect\";\r\n\r\nclass Bluetooth extends React.Component {\r\n  state = {\r\n    supportsBluetooth: false,\r\n    device: null,\r\n    server: null,\r\n    service: null,\r\n    characteristic: null,\r\n    value: null,\r\n    connected: false,\r\n  };\r\n  handleDeviceChange = (device) => {\r\n    this.setState({ device });\r\n  };\r\n  handleServerChange = (server) => {\r\n    this.setState({ server });\r\n  };\r\n  handleServiceChange = (service) => {\r\n    this.setState({ service });\r\n  };\r\n  handleCharacteristicChange = (characteristic) => {\r\n    this.setState({ characteristic });\r\n  };\r\n  handleConnectedChange = (connected) => {\r\n    this.setState({ connected });\r\n  };\r\n  handleSupportsBluetoothChange = (supportsBluetooth) => {\r\n    this.setState({ supportsBluetooth });\r\n  };\r\n\r\n  componentDidMount = () => {\r\n    if (navigator.bluetooth) this.handleSupportsBluetoothChange(true);\r\n  };\r\n\r\n  onDisconnected = () => {\r\n    this.setState({\r\n      connected: false,\r\n    });\r\n  };\r\n\r\n  handleNotifications = (event) => {\r\n    let value = event.target.value;\r\n    let str = \"\";\r\n    for (let i = 0; i < value.byteLength; i++) {\r\n      str += String.fromCharCode(value.getUint8(i));\r\n    }\r\n    this.setState({\r\n      value: str,\r\n    });\r\n  };\r\n\r\n  handleBluetoothInputChange = (value) => {\r\n    let encoder = new TextEncoder();\r\n    console.log(\"Setting Characteristic...\");\r\n\r\n    let array = encoder.encode(value);\r\n    var fin = new Int8Array([13, 10]);\r\n\r\n    var send = new Int8Array(array.length + fin.length);\r\n    send.set(array);\r\n    send.set(fin, array.length);\r\n\r\n    this.state.characteristic\r\n      .writeValue(send)\r\n      .then((_) => {\r\n        console.log(\"> Characteristic changed to: \" + value + \": \" + send);\r\n      })\r\n      .catch((error) => {\r\n        console.log(\"Set Characteristic error: \" + error);\r\n      });\r\n  };\r\n\r\n  render = () => {\r\n    const {\r\n      supportsBluetooth,\r\n      connected,\r\n      device,\r\n      server,\r\n      service,\r\n      characteristic,\r\n    } = this.state;\r\n    return (\r\n      <div className=\"Bluetooth\">\r\n        <h1 className=\"bluetooth-title\">Bluetooth</h1>\r\n        {supportsBluetooth ? (\r\n          <BluetoothConnect\r\n            device={device}\r\n            onDeviceChange={this.handleDeviceChange}\r\n            server={server}\r\n            onServerChange={this.handleServerChange}\r\n            service={service}\r\n            onServiceChange={this.handleServiceChange}\r\n            characteristic={characteristic}\r\n            onCharacteristicChange={this.handleCharacteristicChange}\r\n            connected={connected}\r\n            onConnectedChange={this.handleConnectedChange}\r\n            handleNotifications={this.handleNotifications}\r\n            onDisconnected={this.onDisconnected}\r\n          />\r\n        ) : (\r\n          <div className=\"no-bt\">Este dispositivo no soporta bluetooth.</div>\r\n        )}\r\n        {connected && (\r\n          <div className=\"connected\">\r\n            <BluetoothInput\r\n              onBluetoothInputChange={this.handleBluetoothInputChange}\r\n            />\r\n            <p>{device.name}</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n}\r\n\r\nexport default Bluetooth;\r\n","import React from 'react';\r\nimport './App.css';\r\nimport Bluetooth from './components/Bluetooth';\r\n\r\nconst App = () => {\r\n    return (\r\n        <div className=\"App\">\r\n        <Bluetooth />\r\n        </div>\r\n    );\r\n    }\r\nexport default App;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport App from './App';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}